{"version":3,"sources":["../../src/common/Module.js"],"names":[],"mappings":"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","file":"Module.js","sourcesContent":["import path from 'path';\nimport Loader from './Loader';\nimport Configuration from './Configuration';\n\n/**\n * Module\n */\nclass Module {\n\n    constructor(prefix, config, loader) {\n        this.prefix = prefix;\n        this.config = config;\n        this.loader = loader;\n        this.modules = null;\n    }\n\n    isMain() {\n        return !this.prefix;\n    }\n\n    getSubModules() {\n\n        var prefix;\n        var project;\n        var loader;\n        var config;\n\n        if (this.modules)\n            return this.modules;\n\n        this.modules = this.config.readWithDefaults('modules', []).\n        map((_path) => {\n\n            _path = this.loader.getPath() + '/' + _path;\n            prefix = path.basename(_path);\n            prefix = (this.prefix) ? this.prefix + '.' + prefix : prefix;\n            loader = new Loader(_path);\n            config = loader.loadFromConf('config', {});\n            project = new Module(prefix, new Configuration(config), new Loader(_path));\n            return project;\n\n        });\n\n        return this.modules;\n\n    }\n\n    getLoader() {\n        return this.loader;\n    }\n\n    getConfiguration() {\n        return this.config;\n    }\n\n    setConnections(connections) {\n\n        this.config.readWithDefaults('connections', []).\n        forEach((con) => {\n            connections.create(con.name, con.type, con.options);\n        });\n    }\n\n    register(registry) {\n        this.loader.requireControllers(registry.controllers, this.prefix);\n        this.loader.requireModels(registry.models, this.prefix);\n        this.loader.requireMiddleWare(registry.middleware, this.prefix);\n        this.loader.requirePipes(registry.pipes, this.prefix);\n    }\n\n    runPlugins() {\n        this.config.readWithDefaults('plugins', []).\n        forEach((_path) => {\n            var plugin = this.loader.requireRelative(_path);\n            plugin(this);\n\n        });\n    }\n\n\n}\n\nexport default Module\n"]}