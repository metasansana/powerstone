'use strict';

var RoutingFramework = require('./RoutingFramework');
var merge = require('deepmerge');

function WebAppRoutingFramework() {
    RoutingFramework.apply(this, arguments);
};

WebAppRoutingFramework.prototype = Object.create(RoutingFramework.prototype);
WebAppRoutingFramework.prototype.constructor = WebAppRoutingFramework;

/**
 * configureViews
 */
WebAppRoutingFramework.prototype.configureViews = function (route) {

    if (route.view) this.router.get(route.href, function (req, res) {

        var locals = res.locals || {};
        var session = req.session || {};

        if (route.locals) locals = merge(locals, route.locals);

        if (route.session) {
            route.session.forEach(function (key) {
                locals[key] = session[key];
            });
        }

        res.render(route.view, locals);
    });

    return this;
};

module.exports = WebAppRoutingFramework;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy93ZWIvV2ViQXBwUm91dGluZ0ZyYW1ld29yay5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksZ0JBQWdCLEdBQUcsT0FBTyxDQUFDLG9CQUFvQixDQUFDLENBQUM7QUFDckQsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDOztBQUVqQyxTQUFTLHNCQUFzQixHQUFHO0FBQzlCLG9CQUFnQixDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7Q0FDM0MsQ0FBQzs7QUFFRixzQkFBc0IsQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUM3RSxzQkFBc0IsQ0FBQyxTQUFTLENBQUMsV0FBVyxHQUFHLHNCQUFzQixDQUFDOzs7OztBQUt0RSxzQkFBc0IsQ0FBQyxTQUFTLENBQUMsY0FBYyxHQUFHLFVBQVUsS0FBSyxFQUFFOztBQUUvRCxRQUFJLEtBQUssQ0FBQyxJQUFJLEVBQ1YsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxVQUFVLEdBQUcsRUFBRSxHQUFHLEVBQUU7O0FBRTVDLFlBQUksTUFBTSxHQUFHLEdBQUcsQ0FBQyxNQUFNLElBQUksRUFBRSxDQUFDO0FBQzlCLFlBQUksT0FBTyxHQUFHLEdBQUcsQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDOztBQUVoQyxZQUFHLEtBQUssQ0FBQyxNQUFNLEVBQ2QsTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDOztBQUV0QyxZQUFHLEtBQUssQ0FBQyxPQUFPLEVBQUU7QUFDZCxpQkFBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDakMsc0JBQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDN0IsQ0FBQyxDQUFDO1NBQ047O0FBRUQsV0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0tBRWxDLENBQUMsQ0FBQzs7QUFHUCxXQUFPLElBQUksQ0FBQztDQUVmLENBQUM7O0FBRUYsTUFBTSxDQUFDLE9BQU8sR0FBRyxzQkFBc0IsQ0FBQyIsImZpbGUiOiJXZWJBcHBSb3V0aW5nRnJhbWV3b3JrLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIFJvdXRpbmdGcmFtZXdvcmsgPSByZXF1aXJlKCcuL1JvdXRpbmdGcmFtZXdvcmsnKTtcbnZhciBtZXJnZSA9IHJlcXVpcmUoJ2RlZXBtZXJnZScpO1xuXG5mdW5jdGlvbiBXZWJBcHBSb3V0aW5nRnJhbWV3b3JrKCkge1xuICAgIFJvdXRpbmdGcmFtZXdvcmsuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG5cbldlYkFwcFJvdXRpbmdGcmFtZXdvcmsucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShSb3V0aW5nRnJhbWV3b3JrLnByb3RvdHlwZSk7XG5XZWJBcHBSb3V0aW5nRnJhbWV3b3JrLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFdlYkFwcFJvdXRpbmdGcmFtZXdvcms7XG5cbi8qKlxuICogY29uZmlndXJlVmlld3NcbiAqL1xuV2ViQXBwUm91dGluZ0ZyYW1ld29yay5wcm90b3R5cGUuY29uZmlndXJlVmlld3MgPSBmdW5jdGlvbiAocm91dGUpIHtcblxuICAgIGlmIChyb3V0ZS52aWV3KVxuICAgICAgICB0aGlzLnJvdXRlci5nZXQocm91dGUuaHJlZiwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG5cbiAgICAgICAgICAgIHZhciBsb2NhbHMgPSByZXMubG9jYWxzIHx8IHt9O1xuICAgICAgICAgICAgdmFyIHNlc3Npb24gPSByZXEuc2Vzc2lvbiB8fCB7fTtcblxuICAgICAgICAgICAgaWYocm91dGUubG9jYWxzKVxuICAgICAgICAgICAgIGxvY2FscyA9IG1lcmdlKGxvY2Fscywgcm91dGUubG9jYWxzKTtcblxuICAgICAgICAgICAgaWYocm91dGUuc2Vzc2lvbikge1xuICAgICAgICAgICAgICAgIHJvdXRlLnNlc3Npb24uZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgICAgICAgICBsb2NhbHNba2V5XSA9IHNlc3Npb25ba2V5XTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVzLnJlbmRlcihyb3V0ZS52aWV3LCBsb2NhbHMpO1xuXG4gICAgICAgIH0pO1xuXG5cbiAgICByZXR1cm4gdGhpcztcblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBXZWJBcHBSb3V0aW5nRnJhbWV3b3JrOyJdfQ==